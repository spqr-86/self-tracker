<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Self-Tracker</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
/* =========================
   BASE
========================= */
:root {
  --bg: #f7f7f7;
  --card: #ffffff;
  --text: #222;
  --muted: #777;
  --accent: #5b8def;
  --success: #4caf50;
  --danger: #e53935;
}

* {
  box-sizing: border-box;
  font-family: system-ui, -apple-system, sans-serif;
}

body {
  margin: 0;
  background: var(--bg);
  color: var(--text);
}

h2 {
  margin-top: 0;
}

button {
  cursor: pointer;
  border: none;
  padding: 8px 12px;
  border-radius: 6px;
  background: var(--accent);
  color: white;
}

button.secondary {
  background: #ddd;
  color: #000;
}

button.danger {
  background: var(--danger);
}

input, select, textarea {
  width: 100%;
  padding: 8px;
  margin-bottom: 8px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

textarea {
  resize: vertical;
}

/* =========================
   LAYOUT
========================= */
.app {
  display: flex;
  min-height: 100vh;
}

nav {
  width: 220px;
  background: var(--card);
  padding: 16px;
}

nav button {
  width: 100%;
  margin-bottom: 8px;
  background: none;
  color: var(--text);
  text-align: left;
}

nav button.active {
  background: var(--accent);
  color: white;
}

main {
  flex: 1;
  padding: 16px;
}

.card {
  background: var(--card);
  padding: 16px;
  border-radius: 12px;
  margin-bottom: 16px;
}

/* =========================
   MOBILE
========================= */
@media (max-width: 768px) {
  .app {
    flex-direction: column;
  }
  nav {
    width: 100%;
    display: flex;
    overflow-x: auto;
  }
  nav button {
    flex: 1;
    white-space: nowrap;
  }
}
</style>
</head>

<body>

<div class="app">
  <nav>
    <button class="active" onclick="showSection('workouts')">üèãÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</button>
    <button onclick="showSection('meditation')">üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è</button>
    <button onclick="showSection('code')">üìú –ö–æ–¥–µ–∫—Å</button>
    <button onclick="showSection('goals')">üéØ –¶–µ–ª–∏</button>
    <button onclick="showSection('motivation')">üî• –ú–æ—Ç–∏–≤–∞—Ü–∏—è</button>
    <hr>
    <button onclick="exportData()">‚¨áÔ∏è –≠–∫—Å–ø–æ—Ä—Ç</button>
    <button onclick="importData()">‚¨ÜÔ∏è –ò–º–ø–æ—Ä—Ç</button>
  </nav>

  <main>

    <!-- ================= WORKOUTS ================= -->
    <section id="workouts" class="section">
      <h2>üèãÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</h2>

      <div class="card">
        <h3>–î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</h3>
        <input type="date" id="wDate">
        <input placeholder="–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ" id="wExercise">
        <input type="number" placeholder="–ü–æ–¥—Ö–æ–¥—ã" id="wSets">
        <input type="number" placeholder="–ü–æ–≤—Ç–æ—Ä–µ–Ω–∏—è" id="wReps">
        <input type="number" placeholder="–í–µ—Å" id="wWeight">
        <input placeholder="YouTube —Å—Å—ã–ª–∫–∞" id="wVideo">
        <button onclick="addWorkout()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>

      <div class="card">
        <h3>–ò—Å—Ç–æ—Ä–∏—è</h3>
        <ul id="workoutList"></ul>
      </div>

      <div class="card">
        <h3>–ì—Ä–∞—Ñ–∏–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</h3>
        <canvas id="workoutChart"></canvas>
      </div>
    </section>

    <!-- ================= MEDITATION ================= -->
    <section id="meditation" class="section" style="display:none">
      <h2>üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è</h2>

      <div class="card">
        <input type="date" id="mDate">
        <input type="number" placeholder="–ú–∏–Ω—É—Ç—ã" id="mMinutes">
        <input placeholder="–¢–∏–ø –ø—Ä–∞–∫—Ç–∏–∫–∏" id="mType">
        <textarea placeholder="–ó–∞–º–µ—Ç–∫–∏" id="mNotes"></textarea>
        <button onclick="addMeditation()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      </div>

      <div class="card">
        <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
        <div id="meditationStats"></div>
      </div>

      <div class="card">
        <h3>–ò—Å—Ç–æ—Ä–∏—è</h3>
        <ul id="meditationList"></ul>
      </div>
    </section>

    <!-- ================= CODEX ================= -->
    <section id="code" class="section" style="display:none">
      <h2>üìú –ú–æ–π –ö–æ–¥–µ–∫—Å</h2>

      <div class="card">
        <input placeholder="–ü—Ä–∏–Ω—Ü–∏–ø" id="codeText">
        <select id="codeCategory">
          <option>–†–∞–±–æ—Ç–∞</option>
          <option>–û—Ç–Ω–æ—à–µ–Ω–∏—è</option>
          <option>–ó–¥–æ—Ä–æ–≤—å–µ</option>
        </select>
        <button onclick="addCode()">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>

      <ul id="codeList"></ul>
    </section>

    <!-- ================= GOALS ================= -->
    <section id="goals" class="section" style="display:none">
      <h2>üéØ –¶–µ–ª–∏</h2>

      <div class="card">
        <input placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" id="gName">
        <select id="gType">
          <option>–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è</option>
          <option>–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è</option>
        </select>
        <input type="date" id="gDeadline">
        <input type="number" placeholder="–ü—Ä–æ–≥—Ä–µ—Å—Å %" id="gProgress">
        <button onclick="addGoal()">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>

      <ul id="goalList"></ul>
    </section>

    <!-- ================= MOTIVATION ================= -->
    <section id="motivation" class="section" style="display:none">
      <h2>üî• –ú–æ—Ç–∏–≤–∞—Ü–∏—è</h2>

      <div class="card" id="randomQuote"></div>

      <div class="card">
        <input placeholder="–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ" id="aText">
        <button onclick="addAchievement()">–î–æ–±–∞–≤–∏—Ç—å</button>
      </div>

      <ul id="achievementList"></ul>
    </section>

  </main>
</div>

<script>
/* ================= STORAGE ================= */
const db = {
  workouts: JSON.parse(localStorage.getItem('workouts') || '[]'),
  meditations: JSON.parse(localStorage.getItem('meditations') || '[]'),
  code: JSON.parse(localStorage.getItem('code') || '[]'),
  goals: JSON.parse(localStorage.getItem('goals') || '[]'),
  achievements: JSON.parse(localStorage.getItem('achievements') || '[]'),
};

function save() {
  for (let k in db) localStorage.setItem(k, JSON.stringify(db[k]));
}

/* ================= NAV ================= */
function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
  document.getElementById(id).style.display = 'block';
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
}

/* ================= WORKOUTS ================= */
function addWorkout() {
  db.workouts.push({
    date: wDate.value,
    exercise: wExercise.value,
    sets: wSets.value,
    reps: wReps.value,
    weight: wWeight.value
  });
  save();
  renderWorkouts();
}

function renderWorkouts() {
  workoutList.innerHTML = '';
  db.workouts.forEach(w => {
    const li = document.createElement('li');
    li.textContent = `${w.date} ‚Äî ${w.exercise} ${w.weight}–∫–≥`;
    workoutList.appendChild(li);
  });
  drawChart();
}

function drawChart() {
  const data = db.workouts.map(w => w.weight);
  const labels = db.workouts.map(w => w.date);
  new Chart(workoutChart, {
    type: 'line',
    data: { labels, datasets: [{ label: '–í–µ—Å', data }] }
  });
}

/* ================= MEDITATION ================= */
function addMeditation() {
  db.meditations.push({
    date: mDate.value,
    minutes: +mMinutes.value
  });
  save();
  renderMeditation();
}

function renderMeditation() {
  meditationList.innerHTML = '';
  let total = 0;
  db.meditations.forEach(m => {
    total += m.minutes;
    const li = document.createElement('li');
    li.textContent = `${m.date} ‚Äî ${m.minutes} –º–∏–Ω`;
    meditationList.appendChild(li);
  });
  meditationStats.textContent = `–í—Å–µ–≥–æ –º–∏–Ω—É—Ç: ${total}`;
}

/* ================= CODEX ================= */
function addCode() {
  db.code.push({ text: codeText.value, cat: codeCategory.value });
  save();
  renderCode();
}

function renderCode() {
  codeList.innerHTML = '';
  db.code.forEach(c => {
    const li = document.createElement('li');
    li.textContent = `[${c.cat}] ${c.text}`;
    codeList.appendChild(li);
  });
}

/* ================= GOALS ================= */
function addGoal() {
  db.goals.push({
    name: gName.value,
    type: gType.value,
    deadline: gDeadline.value,
    progress: gProgress.value
  });
  save();
  renderGoals();
}

function renderGoals() {
  goalList.innerHTML = '';
  db.goals.forEach(g => {
    const li = document.createElement('li');
    li.innerHTML = `${g.name} ‚Äî ${g.progress}%<progress max="100" value="${g.progress}"></progress>`;
    goalList.appendChild(li);
  });
}

/* ================= MOTIVATION ================= */
const quotes = [
  "–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ —Å–∏–ª—å–Ω–µ–µ –º–æ—Ç–∏–≤–∞—Ü–∏–∏",
  "–ú–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å",
  "–¢—ã —É–∂–µ –¥–µ–ª–∞–µ—à—å –±–æ–ª—å—à–µ, —á–µ–º –≤—á–µ—Ä–∞"
];

randomQuote.textContent = quotes[Math.floor(Math.random() * quotes.length)];

function addAchievement() {
  db.achievements.push({ text: aText.value, date: new Date().toLocaleDateString() });
  save();
  renderAchievements();
}

function renderAchievements() {
  achievementList.innerHTML = '';
  db.achievements.forEach(a => {
    const li = document.createElement('li');
    li.textContent = `${a.date} ‚Äî ${a.text}`;
    achievementList.appendChild(li);
  });
}

/* ================= IMPORT / EXPORT ================= */
function exportData() {
  const blob = new Blob([JSON.stringify(db)], { type: 'application/json' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'selftracker.json';
  a.click();
}

function importData() {
  const input = document.createElement('input');
  input.type = 'file';
  input.onchange = e => {
    const reader = new FileReader();
    reader.onload = () => {
      Object.assign(db, JSON.parse(reader.result));
      save();
      location.reload();
    };
    reader.readAsText(e.target.files[0]);
  };
  input.click();
}

/* INIT */
renderWorkouts();
renderMeditation();
renderCode();
renderGoals();
renderAchievements();
</script>

</body>
</html>
